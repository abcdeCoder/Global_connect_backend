{"ast":null,"code":"import _slicedToArray from\"D:/New folder (4)/instagram-mern-main/backend/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useRef,useState}from'react';import FavoriteIcon from'@mui/icons-material/Favorite';import ModeCommentIcon from'@mui/icons-material/ModeComment';import{Dialog}from'@mui/material';import{Link}from'react-router-dom';import{commentIcon,emojiIcon,likeIconOutline,saveIconFill,saveIconOutline,shareIcon}from'../../Home/SvgIcons';import{likeFill}from'../../Navbar/SvgIcons';import{useDispatch,useSelector}from'react-redux';import{addComment,clearErrors,deletePost,likePost,savePost}from'../../../actions/postAction';import{Picker}from'emoji-mart';import{metaballsMenu}from'../SvgIcons';import moment from'moment';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var PostItem=function PostItem(_ref){var _id=_ref._id,caption=_ref.caption,likes=_ref.likes,comments=_ref.comments,image=_ref.image,postedBy=_ref.postedBy,savedBy=_ref.savedBy,createdAt=_ref.createdAt;var dispatch=useDispatch();var commentInput=useRef(null);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),open=_useState2[0],setOpen=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),liked=_useState4[0],setLiked=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),saved=_useState6[0],setSaved=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),comment=_useState8[0],setComment=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),showEmojis=_useState10[0],setShowEmojis=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),deleteModal=_useState12[0],setDeleteModal=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),likeEffect=_useState14[0],setLikeEffect=_useState14[1];var _useSelector=useSelector(function(state){return state.user;}),user=_useSelector.user;var handleLike=function handleLike(){setLiked(!liked);dispatch(likePost(_id));};var handleComment=function handleComment(e){e.preventDefault();dispatch(addComment(_id,comment));setComment(\"\");};var handleSave=function handleSave(){setSaved(!saved);dispatch(savePost(_id));};var handleDeletePost=function handleDeletePost(){dispatch(deletePost(_id));setDeleteModal(false);};useEffect(function(){setLiked(likes.some(function(id){return id===user._id;}));},[likes]);useEffect(function(){setSaved(savedBy.some(function(id){return id===user._id;}));},[savedBy]);var closeDeleteModal=function closeDeleteModal(){setDeleteModal(false);};var setLike=function setLike(){setLikeEffect(true);setTimeout(function(){setLikeEffect(false);},500);if(liked){return;}handleLike();};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{onClick:function onClick(){return setOpen(true);},className:\"group w-full h-32 sm:h-72 max-h-72 flex justify-center items-center bg-gray-100 hover:bg-black cursor-pointer relative z-0\",children:[/*#__PURE__*/_jsx(\"img\",{draggable:\"false\",loading:\"lazy\",className:\"hover:opacity-75 group-hover:opacity-75 cursor-pointer object-cover h-full w-full\",src:image,alt:\"Post\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"hidden group-hover:flex text-white absolute pointer-events-none gap-4\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(FavoriteIcon,{}),\" \",likes.length]}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(ModeCommentIcon,{}),\" \",comments.length]})]})]}),/*#__PURE__*/_jsx(Dialog,{open:open,onClose:function onClose(){return setOpen(false);},maxWidth:\"xl\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex sm:flex-row flex-col max-w-7xl\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative flex items-center justify-center bg-black sm:h-[90vh] w-full\",onDoubleClick:setLike,children:[/*#__PURE__*/_jsx(\"img\",{draggable:\"false\",className:\"object-contain h-full w-full\",src:image,alt:\"post\"}),likeEffect&&/*#__PURE__*/_jsx(\"img\",{draggable:\"false\",height:\"80px\",className:\"likeEffect\",alt:\"heart\",src:\"https://img.icons8.com/ios-filled/2x/ffffff/like.png\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col justify-between border w-full max-w-xl rounded bg-white\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between px-3 py-2 border-b items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3 items-center\",children:[/*#__PURE__*/_jsx(Link,{to:\"/\".concat(postedBy.username),children:/*#__PURE__*/_jsx(\"img\",{draggable:\"false\",className:\"w-10 h-10 rounded-full object-cover\",src:postedBy.avatar,alt:\"avatar\"})}),/*#__PURE__*/_jsx(Link,{to:\"/\".concat(postedBy.username),className:\"text-black text-sm font-semibold hover:underline\",children:postedBy.username})]}),/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){return setDeleteModal(true);},className:\"cursor-pointer\",children:metaballsMenu})]}),/*#__PURE__*/_jsx(Dialog,{open:deleteModal,onClose:closeDeleteModal,maxWidth:\"xl\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center w-80\",children:[postedBy._id===user._id&&/*#__PURE__*/_jsx(\"button\",{onClick:handleDeletePost,className:\"text-red-600 font-medium border-b py-2.5 w-full hover:bg-red-50\",children:\"Delete\"}),/*#__PURE__*/_jsx(\"button\",{onClick:closeDeleteModal,className:\"py-2.5 w-full hover:bg-gray-50\",children:\"Cancel\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 w-full flex-1 max-h-[63vh] overscroll-x-hidden overflow-y-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start\",children:[/*#__PURE__*/_jsx(Link,{to:\"/\".concat(postedBy.username),className:\"w-12\",children:/*#__PURE__*/_jsx(\"img\",{draggable:\"false\",className:\"w-9 h-9 rounded-full object-cover\",src:postedBy.avatar,alt:\"avatar\"})}),/*#__PURE__*/_jsx(Link,{to:\"/\".concat(postedBy.username),className:\"text-sm font-semibold hover:underline mr-2\",children:postedBy.username})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm whitespace-pre-line ml-12 -mt-4 mb-3.5\",children:caption}),comments.map(function(c){return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start space-x-1 mb-3\",children:[/*#__PURE__*/_jsx(Link,{to:\"/\".concat(c.user),children:/*#__PURE__*/_jsx(\"img\",{draggable:\"false\",className:\"w-9 h-9 rounded-full object-cover mr-2.5\",src:c.user.avatar,alt:\"avatar\"})}),/*#__PURE__*/_jsx(Link,{to:\"/\".concat(c.user),className:\"text-sm font-semibold hover:underline\",children:c.user.username}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm whitespace-pre-line\",children:c.comment})]},c._id);})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col px-3 space-y-1 border-b border-t pb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between py-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleLike,children:liked?likeFill:likeIconOutline}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return commentInput.current.focus();},children:commentIcon}),shareIcon]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSave,children:saved?saveIconFill:saveIconOutline})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"w-full font-semibold text-sm\",children:[likes.length,\" likes\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-gray-500\",children:moment(createdAt).fromNow()})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleComment,className:\"flex items-center justify-between p-3 w-full space-x-3 relative\",children:[/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){return setShowEmojis(!showEmojis);},className:\"cursor-pointer\",children:emojiIcon}),showEmojis&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute bottom-12 -left-20\",children:/*#__PURE__*/_jsx(Picker,{set:\"google\",onSelect:function onSelect(e){return setComment(comment+e.native);},title:\"Emojis\"})}),/*#__PURE__*/_jsx(\"input\",{className:\"flex-auto text-sm outline-none border-none bg-transparent\",type:\"text\",value:comment,ref:commentInput,required:true,onClick:function onClick(){return setShowEmojis(false);},onChange:function onChange(e){return setComment(e.target.value);},placeholder:\"Add a comment...\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"\".concat(comment.trim().length<1?'text-blue-300':'text-primary-blue',\" text-sm font-semibold\"),disabled:comment.trim().length<1,children:\"Post\"})]})]})]})]})})]});};export default PostItem;","map":{"version":3,"sources":["D:/New folder (4)/instagram-mern-main/backend/frontend/src/components/User/Posts/PostItem.jsx"],"names":["useEffect","useRef","useState","FavoriteIcon","ModeCommentIcon","Dialog","Link","commentIcon","emojiIcon","likeIconOutline","saveIconFill","saveIconOutline","shareIcon","likeFill","useDispatch","useSelector","addComment","clearErrors","deletePost","likePost","savePost","Picker","metaballsMenu","moment","PostItem","_id","caption","likes","comments","image","postedBy","savedBy","createdAt","dispatch","commentInput","open","setOpen","liked","setLiked","saved","setSaved","comment","setComment","showEmojis","setShowEmojis","deleteModal","setDeleteModal","likeEffect","setLikeEffect","state","user","handleLike","handleComment","e","preventDefault","handleSave","handleDeletePost","some","id","closeDeleteModal","setLike","setTimeout","length","username","avatar","map","c","current","focus","fromNow","native","target","value","trim"],"mappings":"4IAAA,OAASA,SAAT,CAAoBC,MAApB,CAA4BC,QAA5B,KAA4C,OAA5C,CACA,MAAOC,CAAAA,YAAP,KAAyB,8BAAzB,CACA,MAAOC,CAAAA,eAAP,KAA4B,iCAA5B,CACA,OAASC,MAAT,KAAuB,eAAvB,CACA,OAASC,IAAT,KAAqB,kBAArB,CACA,OAASC,WAAT,CAAsBC,SAAtB,CAAiCC,eAAjC,CAAkDC,YAAlD,CAAgEC,eAAhE,CAAiFC,SAAjF,KAAkG,qBAAlG,CACA,OAASC,QAAT,KAAyB,uBAAzB,CACA,OAASC,WAAT,CAAsBC,WAAtB,KAAyC,aAAzC,CACA,OAASC,UAAT,CAAqBC,WAArB,CAAkCC,UAAlC,CAA8CC,QAA9C,CAAwDC,QAAxD,KAAwE,6BAAxE,CACA,OAASC,MAAT,KAAuB,YAAvB,CACA,OAASC,aAAT,KAA8B,aAA9B,CACA,MAAOC,CAAAA,MAAP,KAAmB,QAAnB,C,6IAEA,GAAMC,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,MAA4E,IAAzEC,CAAAA,GAAyE,MAAzEA,GAAyE,CAApEC,OAAoE,MAApEA,OAAoE,CAA3DC,KAA2D,MAA3DA,KAA2D,CAApDC,QAAoD,MAApDA,QAAoD,CAA1CC,KAA0C,MAA1CA,KAA0C,CAAnCC,QAAmC,MAAnCA,QAAmC,CAAzBC,OAAyB,MAAzBA,OAAyB,CAAhBC,SAAgB,MAAhBA,SAAgB,CAEzF,GAAMC,CAAAA,QAAQ,CAAGnB,WAAW,EAA5B,CACA,GAAMoB,CAAAA,YAAY,CAAGjC,MAAM,CAAC,IAAD,CAA3B,CAEA,cAAwBC,QAAQ,CAAC,KAAD,CAAhC,wCAAOiC,IAAP,eAAaC,OAAb,eACA,eAA0BlC,QAAQ,CAAC,KAAD,CAAlC,yCAAOmC,KAAP,eAAcC,QAAd,eACA,eAA0BpC,QAAQ,CAAC,KAAD,CAAlC,yCAAOqC,KAAP,eAAcC,QAAd,eACA,eAA8BtC,QAAQ,CAAC,EAAD,CAAtC,yCAAOuC,OAAP,eAAgBC,UAAhB,eACA,eAAoCxC,QAAQ,CAAC,KAAD,CAA5C,0CAAOyC,UAAP,gBAAmBC,aAAnB,gBACA,gBAAsC1C,QAAQ,CAAC,KAAD,CAA9C,2CAAO2C,WAAP,gBAAoBC,cAApB,gBAEA,gBAAoC5C,QAAQ,CAAC,KAAD,CAA5C,2CAAO6C,UAAP,gBAAmBC,aAAnB,gBAEA,iBAAiBjC,WAAW,CAAC,SAACkC,KAAD,QAAWA,CAAAA,KAAK,CAACC,IAAjB,EAAD,CAA5B,CAAQA,IAAR,cAAQA,IAAR,CAEA,GAAMC,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,EAAM,CACrBb,QAAQ,CAAC,CAACD,KAAF,CAAR,CACAJ,QAAQ,CAACd,QAAQ,CAACM,GAAD,CAAT,CAAR,CACH,CAHD,CAKA,GAAM2B,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAACC,CAAD,CAAO,CACzBA,CAAC,CAACC,cAAF,GACArB,QAAQ,CAACjB,UAAU,CAACS,GAAD,CAAMgB,OAAN,CAAX,CAAR,CACAC,UAAU,CAAC,EAAD,CAAV,CACH,CAJD,CAMA,GAAMa,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,EAAM,CACrBf,QAAQ,CAAC,CAACD,KAAF,CAAR,CACAN,QAAQ,CAACb,QAAQ,CAACK,GAAD,CAAT,CAAR,CACH,CAHD,CAKA,GAAM+B,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,EAAM,CAC3BvB,QAAQ,CAACf,UAAU,CAACO,GAAD,CAAX,CAAR,CACAqB,cAAc,CAAC,KAAD,CAAd,CACH,CAHD,CAKA9C,SAAS,CAAC,UAAM,CACZsC,QAAQ,CAACX,KAAK,CAAC8B,IAAN,CAAW,SAACC,EAAD,QAAQA,CAAAA,EAAE,GAAKR,IAAI,CAACzB,GAApB,EAAX,CAAD,CAAR,CACH,CAFQ,CAEN,CAACE,KAAD,CAFM,CAAT,CAIA3B,SAAS,CAAC,UAAM,CACZwC,QAAQ,CAACT,OAAO,CAAC0B,IAAR,CAAa,SAACC,EAAD,QAAQA,CAAAA,EAAE,GAAKR,IAAI,CAACzB,GAApB,EAAb,CAAD,CAAR,CACH,CAFQ,CAEN,CAACM,OAAD,CAFM,CAAT,CAIA,GAAM4B,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,EAAM,CAC3Bb,cAAc,CAAC,KAAD,CAAd,CACH,CAFD,CAIA,GAAMc,CAAAA,OAAO,CAAG,QAAVA,CAAAA,OAAU,EAAM,CAClBZ,aAAa,CAAC,IAAD,CAAb,CACAa,UAAU,CAAC,UAAM,CACbb,aAAa,CAAC,KAAD,CAAb,CACH,CAFS,CAEP,GAFO,CAAV,CAGA,GAAIX,KAAJ,CAAW,CACP,OACH,CACDc,UAAU,GACb,CATD,CAWA,mBACI,wCACI,aAAK,OAAO,CAAE,yBAAMf,CAAAA,OAAO,CAAC,IAAD,CAAb,EAAd,CAAmC,SAAS,CAAC,4HAA7C,wBACI,YAAK,SAAS,CAAC,OAAf,CAAuB,OAAO,CAAC,MAA/B,CAAsC,SAAS,CAAC,mFAAhD,CAAoI,GAAG,CAAEP,KAAzI,CAAgJ,GAAG,CAAC,MAApJ,EADJ,cAEI,aAAK,SAAS,CAAC,uEAAf,wBACI,qCAAM,KAAC,YAAD,IAAN,KAAwBF,KAAK,CAACmC,MAA9B,GADJ,cAEI,qCAAM,KAAC,eAAD,IAAN,KAA2BlC,QAAQ,CAACkC,MAApC,GAFJ,GAFJ,GADJ,cASI,KAAC,MAAD,EAAQ,IAAI,CAAE3B,IAAd,CAAoB,OAAO,CAAE,yBAAMC,CAAAA,OAAO,CAAC,KAAD,CAAb,EAA7B,CAAmD,QAAQ,CAAC,IAA5D,uBACI,aAAK,SAAS,CAAC,qCAAf,wBAEI,aAAK,SAAS,CAAC,uEAAf,CAAuF,aAAa,CAAEwB,OAAtG,wBACI,YAAK,SAAS,CAAC,OAAf,CAAuB,SAAS,CAAC,8BAAjC,CAAgE,GAAG,CAAE/B,KAArE,CAA4E,GAAG,CAAC,MAAhF,EADJ,CAEKkB,UAAU,eACP,YAAK,SAAS,CAAC,OAAf,CAAuB,MAAM,CAAC,MAA9B,CAAqC,SAAS,CAAC,YAA/C,CAA4D,GAAG,CAAC,OAAhE,CAAwE,GAAG,CAAC,sDAA5E,EAHR,GAFJ,cASI,aAAK,SAAS,CAAC,uEAAf,wBAGI,aAAK,SAAS,CAAC,sDAAf,wBAEI,aAAK,SAAS,CAAC,6BAAf,wBACI,KAAC,IAAD,EAAM,EAAE,YAAMjB,QAAQ,CAACiC,QAAf,CAAR,uBAAmC,YAAK,SAAS,CAAC,OAAf,CAAuB,SAAS,CAAC,qCAAjC,CAAuE,GAAG,CAAEjC,QAAQ,CAACkC,MAArF,CAA6F,GAAG,CAAC,QAAjG,EAAnC,EADJ,cAEI,KAAC,IAAD,EAAM,EAAE,YAAMlC,QAAQ,CAACiC,QAAf,CAAR,CAAmC,SAAS,CAAC,kDAA7C,UAAiGjC,QAAQ,CAACiC,QAA1G,EAFJ,GAFJ,cAMI,aAAM,OAAO,CAAE,yBAAMjB,CAAAA,cAAc,CAAC,IAAD,CAApB,EAAf,CAA2C,SAAS,CAAC,gBAArD,UAAuExB,aAAvE,EANJ,GAHJ,cAYI,KAAC,MAAD,EAAQ,IAAI,CAAEuB,WAAd,CAA2B,OAAO,CAAEc,gBAApC,CAAsD,QAAQ,CAAC,IAA/D,uBACI,aAAK,SAAS,CAAC,iCAAf,WACK7B,QAAQ,CAACL,GAAT,GAAiByB,IAAI,CAACzB,GAAtB,eACG,eAAQ,OAAO,CAAE+B,gBAAjB,CAAmC,SAAS,CAAC,iEAA7C,oBAFR,cAII,eAAQ,OAAO,CAAEG,gBAAjB,CAAmC,SAAS,CAAC,gCAA7C,oBAJJ,GADJ,EAZJ,cAsBI,aAAK,SAAS,CAAC,oEAAf,wBAEI,aAAK,SAAS,CAAC,kBAAf,wBACI,KAAC,IAAD,EAAM,EAAE,YAAM7B,QAAQ,CAACiC,QAAf,CAAR,CAAmC,SAAS,CAAC,MAA7C,uBAAoD,YAAK,SAAS,CAAC,OAAf,CAAuB,SAAS,CAAC,mCAAjC,CAAqE,GAAG,CAAEjC,QAAQ,CAACkC,MAAnF,CAA2F,GAAG,CAAC,QAA/F,EAApD,EADJ,cAEI,KAAC,IAAD,EAAM,EAAE,YAAMlC,QAAQ,CAACiC,QAAf,CAAR,CAAmC,SAAS,CAAC,4CAA7C,UAA2FjC,QAAQ,CAACiC,QAApG,EAFJ,GAFJ,cAMI,UAAG,SAAS,CAAC,gDAAb,UAA+DrC,OAA/D,EANJ,CAQKE,QAAQ,CAACqC,GAAT,CAAa,SAACC,CAAD,qBACV,aAAK,SAAS,CAAC,iCAAf,wBACI,KAAC,IAAD,EAAM,EAAE,YAAMA,CAAC,CAAChB,IAAR,CAAR,uBAAwB,YAAK,SAAS,CAAC,OAAf,CAAuB,SAAS,CAAC,0CAAjC,CAA4E,GAAG,CAAEgB,CAAC,CAAChB,IAAF,CAAOc,MAAxF,CAAgG,GAAG,CAAC,QAApG,EAAxB,EADJ,cAEI,KAAC,IAAD,EAAM,EAAE,YAAME,CAAC,CAAChB,IAAR,CAAR,CAAwB,SAAS,CAAC,uCAAlC,UAA2EgB,CAAC,CAAChB,IAAF,CAAOa,QAAlF,EAFJ,cAGI,UAAG,SAAS,CAAC,6BAAb,UAA4CG,CAAC,CAACzB,OAA9C,EAHJ,GAAsDyB,CAAC,CAACzC,GAAxD,CADU,EAAb,CARL,GAtBJ,cAuCI,aAAK,SAAS,CAAC,EAAf,wBAEI,aAAK,SAAS,CAAC,qDAAf,wBAEI,aAAK,SAAS,CAAC,wCAAf,wBAEI,aAAK,SAAS,CAAC,gBAAf,wBACI,eAAQ,OAAO,CAAE0B,UAAjB,UAA8Bd,KAAK,CAAGxB,QAAH,CAAcJ,eAAjD,EADJ,cAEI,eAAQ,OAAO,CAAE,yBAAMyB,CAAAA,YAAY,CAACiC,OAAb,CAAqBC,KAArB,EAAN,EAAjB,UAAsD7D,WAAtD,EAFJ,CAGKK,SAHL,GAFJ,cAOI,eAAQ,OAAO,CAAE2C,UAAjB,UAA8BhB,KAAK,CAAG7B,YAAH,CAAkBC,eAArD,EAPJ,GAFJ,cAaI,cAAM,SAAS,CAAC,8BAAhB,WAAgDgB,KAAK,CAACmC,MAAtD,YAbJ,cAgBI,aAAM,SAAS,CAAC,uBAAhB,UAAyCvC,MAAM,CAACS,SAAD,CAAN,CAAkBqC,OAAlB,EAAzC,EAhBJ,GAFJ,cAsBI,cAAM,QAAQ,CAAEjB,aAAhB,CAA+B,SAAS,CAAC,iEAAzC,wBACI,aAAM,OAAO,CAAE,yBAAMR,CAAAA,aAAa,CAAC,CAACD,UAAF,CAAnB,EAAf,CAAiD,SAAS,CAAC,gBAA3D,UAA6EnC,SAA7E,EADJ,CAGKmC,UAAU,eACP,YAAK,SAAS,CAAC,6BAAf,uBACI,KAAC,MAAD,EACI,GAAG,CAAC,QADR,CAEI,QAAQ,CAAE,kBAACU,CAAD,QAAOX,CAAAA,UAAU,CAACD,OAAO,CAAGY,CAAC,CAACiB,MAAb,CAAjB,EAFd,CAGI,KAAK,CAAC,QAHV,EADJ,EAJR,cAaI,cACI,SAAS,CAAC,2DADd,CAEI,IAAI,CAAC,MAFT,CAGI,KAAK,CAAE7B,OAHX,CAII,GAAG,CAAEP,YAJT,CAKI,QAAQ,KALZ,CAMI,OAAO,CAAE,yBAAMU,CAAAA,aAAa,CAAC,KAAD,CAAnB,EANb,CAOI,QAAQ,CAAE,kBAACS,CAAD,QAAOX,CAAAA,UAAU,CAACW,CAAC,CAACkB,MAAF,CAASC,KAAV,CAAjB,EAPd,CAQI,WAAW,CAAC,kBARhB,EAbJ,cAsBI,eAAQ,IAAI,CAAC,QAAb,CAAsB,SAAS,WAAK/B,OAAO,CAACgC,IAAR,GAAeX,MAAf,CAAwB,CAAxB,CAA4B,eAA5B,CAA8C,mBAAnD,0BAA/B,CAA+H,QAAQ,CAAErB,OAAO,CAACgC,IAAR,GAAeX,MAAf,CAAwB,CAAjK,kBAtBJ,GAtBJ,GAvCJ,GATJ,GADJ,EATJ,GADJ,CAgHH,CA5KD,CA8KA,cAAetC,CAAAA,QAAf","sourcesContent":["import { useEffect, useRef, useState } from 'react'\nimport FavoriteIcon from '@mui/icons-material/Favorite';\nimport ModeCommentIcon from '@mui/icons-material/ModeComment';\nimport { Dialog } from '@mui/material';\nimport { Link } from 'react-router-dom';\nimport { commentIcon, emojiIcon, likeIconOutline, saveIconFill, saveIconOutline, shareIcon } from '../../Home/SvgIcons';\nimport { likeFill } from '../../Navbar/SvgIcons';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { addComment, clearErrors, deletePost, likePost, savePost } from '../../../actions/postAction';\nimport { Picker } from 'emoji-mart';\nimport { metaballsMenu } from '../SvgIcons';\nimport moment from 'moment';\n\nconst PostItem = ({ _id, caption, likes, comments, image, postedBy, savedBy, createdAt }) => {\n\n    const dispatch = useDispatch();\n    const commentInput = useRef(null);\n\n    const [open, setOpen] = useState(false);\n    const [liked, setLiked] = useState(false);\n    const [saved, setSaved] = useState(false);\n    const [comment, setComment] = useState(\"\");\n    const [showEmojis, setShowEmojis] = useState(false);\n    const [deleteModal, setDeleteModal] = useState(false);\n\n    const [likeEffect, setLikeEffect] = useState(false);\n\n    const { user } = useSelector((state) => state.user);\n\n    const handleLike = () => {\n        setLiked(!liked);\n        dispatch(likePost(_id));\n    }\n\n    const handleComment = (e) => {\n        e.preventDefault();\n        dispatch(addComment(_id, comment));\n        setComment(\"\");\n    }\n\n    const handleSave = () => {\n        setSaved(!saved);\n        dispatch(savePost(_id));\n    }\n\n    const handleDeletePost = () => {\n        dispatch(deletePost(_id));\n        setDeleteModal(false)\n    }\n\n    useEffect(() => {\n        setLiked(likes.some((id) => id === user._id))\n    }, [likes]);\n\n    useEffect(() => {\n        setSaved(savedBy.some((id) => id === user._id))\n    }, [savedBy]);\n\n    const closeDeleteModal = () => {\n        setDeleteModal(false)\n    }\n\n    const setLike = () => {\n        setLikeEffect(true)\n        setTimeout(() => {\n            setLikeEffect(false)\n        }, 500)\n        if (liked) {\n            return;\n        }\n        handleLike();\n    }\n\n    return (\n        <>\n            <div onClick={() => setOpen(true)} className=\"group w-full h-32 sm:h-72 max-h-72 flex justify-center items-center bg-gray-100 hover:bg-black cursor-pointer relative z-0\">\n                <img draggable=\"false\" loading=\"lazy\" className=\"hover:opacity-75 group-hover:opacity-75 cursor-pointer object-cover h-full w-full\" src={image} alt=\"Post\" />\n                <div className=\"hidden group-hover:flex text-white absolute pointer-events-none gap-4\">\n                    <span><FavoriteIcon /> {likes.length}</span>\n                    <span><ModeCommentIcon /> {comments.length}</span>\n                </div>\n            </div>\n\n            <Dialog open={open} onClose={() => setOpen(false)} maxWidth='xl'>\n                <div className=\"flex sm:flex-row flex-col max-w-7xl\">\n\n                    <div className=\"relative flex items-center justify-center bg-black sm:h-[90vh] w-full\" onDoubleClick={setLike}>\n                        <img draggable=\"false\" className=\"object-contain h-full w-full\" src={image} alt=\"post\" />\n                        {likeEffect &&\n                            <img draggable=\"false\" height=\"80px\" className=\"likeEffect\" alt=\"heart\" src=\"https://img.icons8.com/ios-filled/2x/ffffff/like.png\" />\n                        }\n                    </div>\n\n                    <div className=\"flex flex-col justify-between border w-full max-w-xl rounded bg-white\">\n\n                        {/* id with menu icon */}\n                        <div className=\"flex justify-between px-3 py-2 border-b items-center\">\n                            {/* icon with name */}\n                            <div className=\"flex space-x-3 items-center\">\n                                <Link to={`/${postedBy.username}`}><img draggable=\"false\" className=\"w-10 h-10 rounded-full object-cover\" src={postedBy.avatar} alt=\"avatar\" /></Link>\n                                <Link to={`/${postedBy.username}`} className=\"text-black text-sm font-semibold hover:underline\">{postedBy.username}</Link>\n                            </div>\n                            <span onClick={() => setDeleteModal(true)} className=\"cursor-pointer\">{metaballsMenu}</span>\n                        </div>\n\n                        <Dialog open={deleteModal} onClose={closeDeleteModal} maxWidth='xl'>\n                            <div className=\"flex flex-col items-center w-80\">\n                                {postedBy._id === user._id &&\n                                    <button onClick={handleDeletePost} className=\"text-red-600 font-medium border-b py-2.5 w-full hover:bg-red-50\">Delete</button>\n                                }\n                                <button onClick={closeDeleteModal} className=\"py-2.5 w-full hover:bg-gray-50\">Cancel</button>\n                            </div>\n                        </Dialog>\n\n                        {/* comments */}\n                        <div className=\"p-4 w-full flex-1 max-h-[63vh] overscroll-x-hidden overflow-y-auto\">\n\n                            <div className=\"flex items-start\">\n                                <Link to={`/${postedBy.username}`} className=\"w-12\"><img draggable=\"false\" className=\"w-9 h-9 rounded-full object-cover\" src={postedBy.avatar} alt=\"avatar\" /></Link>\n                                <Link to={`/${postedBy.username}`} className=\"text-sm font-semibold hover:underline mr-2\">{postedBy.username}</Link>\n                            </div>\n                            <p className=\"text-sm whitespace-pre-line ml-12 -mt-4 mb-3.5\">{caption}</p>\n\n                            {comments.map((c) => (\n                                <div className=\"flex items-start space-x-1 mb-3\" key={c._id}>\n                                    <Link to={`/${c.user}`}><img draggable=\"false\" className=\"w-9 h-9 rounded-full object-cover mr-2.5\" src={c.user.avatar} alt=\"avatar\" /></Link>\n                                    <Link to={`/${c.user}`} className=\"text-sm font-semibold hover:underline\">{c.user.username}</Link>\n                                    <p className=\"text-sm whitespace-pre-line\">{c.comment}</p>\n                                </div>\n                            ))}\n                        </div>\n\n                        <div className=\"\">\n                            {/* like comment container */}\n                            <div className=\"flex flex-col px-3 space-y-1 border-b border-t pb-2\">\n                                {/* icons container */}\n                                <div className=\"flex items-center justify-between py-2\">\n                                    {/* left icons container */}\n                                    <div className=\"flex space-x-4\">\n                                        <button onClick={handleLike}>{liked ? likeFill : likeIconOutline}</button>\n                                        <button onClick={() => commentInput.current.focus()}>{commentIcon}</button>\n                                        {shareIcon}\n                                    </div>\n                                    <button onClick={handleSave}>{saved ? saveIconFill : saveIconOutline}</button>\n                                </div>\n\n                                {/* likes  */}\n                                <span className=\"w-full font-semibold text-sm\">{likes.length} likes</span>\n\n                                {/* time */}\n                                <span className=\"text-xs text-gray-500\">{moment(createdAt).fromNow()}</span>\n                            </div>\n\n                            {/* comment input */}\n                            <form onSubmit={handleComment} className=\"flex items-center justify-between p-3 w-full space-x-3 relative\">\n                                <span onClick={() => setShowEmojis(!showEmojis)} className=\"cursor-pointer\">{emojiIcon}</span>\n\n                                {showEmojis && (\n                                    <div className=\"absolute bottom-12 -left-20\">\n                                        <Picker\n                                            set=\"google\"\n                                            onSelect={(e) => setComment(comment + e.native)}\n                                            title=\"Emojis\"\n                                        />\n                                    </div>\n                                )}\n\n                                <input\n                                    className=\"flex-auto text-sm outline-none border-none bg-transparent\"\n                                    type=\"text\"\n                                    value={comment}\n                                    ref={commentInput}\n                                    required\n                                    onClick={() => setShowEmojis(false)}\n                                    onChange={(e) => setComment(e.target.value)}\n                                    placeholder=\"Add a comment...\" />\n                                <button type=\"submit\" className={`${comment.trim().length < 1 ? 'text-blue-300' : 'text-primary-blue'} text-sm font-semibold`} disabled={comment.trim().length < 1}>Post</button>\n                            </form>\n                        </div>\n\n                    </div>\n                </div>\n            </Dialog>\n        </>\n    )\n}\n\nexport default PostItem"]},"metadata":{},"sourceType":"module"}