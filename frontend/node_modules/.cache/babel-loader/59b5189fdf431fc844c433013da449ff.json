{"ast":null,"code":"import _asyncToGenerator from\"D:/New folder (4)/instagram-mern-main/backend/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/New folder (4)/instagram-mern-main/backend/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"D:\\\\New folder (4)\\\\instagram-mern-main\\\\backend\\\\frontend\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import Dialog from'@mui/material/Dialog';import axios from'axios';import{useEffect,useState}from'react';import{useDispatch,useSelector}from'react-redux';import{useNavigate}from'react-router-dom';import{NEW_CHAT_RESET}from'../../constants/chatConstants';import{toast}from'react-toastify';import{addNewChat,clearErrors}from'../../actions/chatAction';import{Skeleton}from'@mui/material';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var NewDialog=function NewDialog(_ref){var open=_ref.open,onClose=_ref.onClose;var dispatch=useDispatch();var navigate=useNavigate();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),users=_useState2[0],setUsers=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),searchTerm=_useState4[0],setSearchTerm=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];var _useSelector=useSelector(function(state){return state.user;}),self=_useSelector.user;var _useSelector2=useSelector(function(state){return state.newChat;}),error=_useSelector2.error,chat=_useSelector2.chat;var fetchUsers=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(term){var _yield$axios$get,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoading(true);_context.next=3;return axios.get(\"/api/v1/users?keyword=\".concat(term));case 3:_yield$axios$get=_context.sent;data=_yield$axios$get.data;setUsers(data.users.filter(function(u){return u._id!==self._id;}));setLoading(false);case 7:case\"end\":return _context.stop();}}},_callee);}));return function fetchUsers(_x){return _ref2.apply(this,arguments);};}();useEffect(function(){if(searchTerm.trim().length>0){fetchUsers(searchTerm);}return function(){setUsers([]);};},[searchTerm]);var addToChat=function addToChat(userId){dispatch(addNewChat(userId));setSearchTerm(\"\");};useEffect(function(){if(error){toast.error(error);dispatch(clearErrors());}if(chat){var _chat$users;var friendId=(_chat$users=chat.users)===null||_chat$users===void 0?void 0:_chat$users.find(function(id){return id!==self._id;});navigate(\"/direct/t/\".concat(chat._id,\"/\").concat(friendId));dispatch({type:NEW_CHAT_RESET});onClose();}},[dispatch,error,chat,navigate]);return/*#__PURE__*/_jsx(Dialog,{open:open,onClose:onClose,children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col w-80 sm:w-96\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center px-4 border-b py-2.5\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium mx-auto\",children:\"New Message\"}),/*#__PURE__*/_jsxs(\"svg\",{onClick:onClose,className:\"cursor-pointer\",\"aria-label\":\"Close\",color:\"#262626\",fill:\"#262626\",height:\"24\",role:\"img\",viewBox:\"0 0 24 24\",width:\"24\",children:[/*#__PURE__*/_jsx(\"line\",{fill:\"none\",stroke:\"currentColor\",strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",x1:\"21\",x2:\"3\",y1:\"3\",y2:\"21\"}),/*#__PURE__*/_jsx(\"line\",{fill:\"none\",stroke:\"currentColor\",strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",x1:\"21\",x2:\"3\",y1:\"21\",y2:\"3\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 border-b p-3\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"To:\"}),/*#__PURE__*/_jsx(\"input\",{className:\"outline-none w-full\",type:\"text\",placeholder:\"Search User..\",value:searchTerm,onChange:function onChange(e){return setSearchTerm(e.target.value);}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col overflow-x-hidden h-96 w-full\",children:loading?Array(8).fill(\"\").map(function(el,i){return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 py-2 px-4\",children:[/*#__PURE__*/_jsx(Skeleton,{animation:\"wave\",variant:\"circular\",width:60,height:50}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col gap-0 w-full\",children:[/*#__PURE__*/_jsx(Skeleton,{height:23,width:\"45%\",animation:\"wave\"}),/*#__PURE__*/_jsx(Skeleton,{height:23,width:\"30%\",animation:\"wave\"})]})]},i);}):users.length>0?users.map(function(u){return/*#__PURE__*/_jsx(\"div\",{onClick:function onClick(){return addToChat(u._id);},className:\"flex items-center hover:bg-gray-50 py-2 px-4 cursor-pointer\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3 items-center\",children:[/*#__PURE__*/_jsx(\"img\",{draggable:\"false\",className:\"w-11 h-11 rounded-full object-cover\",src:u.avatar,alt:\"avatar\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-start\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-black text-sm font-semibold\",children:u.username}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-400 text-sm\",children:u.name})]})]})},u._id);}):/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-400 text-sm p-2\",children:\"No accounts found.\"})})]})});};export default NewDialog;","map":{"version":3,"sources":["D:/New folder (4)/instagram-mern-main/backend/frontend/src/components/Chats/SearchModal.jsx"],"names":["Dialog","axios","useEffect","useState","useDispatch","useSelector","useNavigate","NEW_CHAT_RESET","toast","addNewChat","clearErrors","Skeleton","NewDialog","open","onClose","dispatch","navigate","users","setUsers","searchTerm","setSearchTerm","loading","setLoading","state","user","self","newChat","error","chat","fetchUsers","term","get","data","filter","u","_id","trim","length","addToChat","userId","friendId","find","id","type","e","target","value","Array","fill","map","el","i","avatar","username","name"],"mappings":"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","sourcesContent":["import Dialog from '@mui/material/Dialog';\nimport axios from 'axios';\nimport { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useNavigate } from 'react-router-dom';\nimport { NEW_CHAT_RESET } from '../../constants/chatConstants';\nimport { toast } from 'react-toastify';\nimport { addNewChat, clearErrors } from '../../actions/chatAction';\nimport { Skeleton } from '@mui/material';\n\nconst NewDialog = ({ open, onClose }) => {\n\n    const dispatch = useDispatch();\n    const navigate = useNavigate();\n\n    const [users, setUsers] = useState([]);\n    const [searchTerm, setSearchTerm] = useState(\"\");\n    const [loading, setLoading] = useState(false);\n\n    const { user: self } = useSelector((state) => state.user);\n    const { error, chat } = useSelector((state) => state.newChat);\n\n    const fetchUsers = async (term) => {\n        setLoading(true);\n        const { data } = await axios.get(`/api/v1/users?keyword=${term}`);\n        setUsers(data.users.filter((u) => u._id !== self._id));\n        setLoading(false);\n    }\n\n    useEffect(() => {\n        if (searchTerm.trim().length > 0) {\n            fetchUsers(searchTerm);\n        }\n\n        return () => {\n            setUsers([]);\n        }\n    }, [searchTerm]);\n\n    const addToChat = (userId) => {\n        dispatch(addNewChat(userId));\n        setSearchTerm(\"\")\n    }\n\n    useEffect(() => {\n        if (error) {\n            toast.error(error);\n            dispatch(clearErrors());\n        }\n        if (chat) {\n            const friendId = chat.users?.find((id) => id !== self._id);\n            navigate(`/direct/t/${chat._id}/${friendId}`);\n            dispatch({ type: NEW_CHAT_RESET });\n            onClose();\n        }\n    }, [dispatch, error, chat, navigate]);\n\n    return (\n        <Dialog open={open} onClose={onClose}>\n            <div className=\"flex flex-col w-80 sm:w-96\">\n                <div className=\"flex justify-between items-center px-4 border-b py-2.5\">\n                    <span className=\"font-medium mx-auto\">New Message</span>\n                    <svg onClick={onClose} className=\"cursor-pointer\" aria-label=\"Close\" color=\"#262626\" fill=\"#262626\" height=\"24\" role=\"img\" viewBox=\"0 0 24 24\" width=\"24\"><line fill=\"none\" stroke=\"currentColor\" strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" x1=\"21\" x2=\"3\" y1=\"3\" y2=\"21\"></line><line fill=\"none\" stroke=\"currentColor\" strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" x1=\"21\" x2=\"3\" y1=\"21\" y2=\"3\"></line></svg>\n                </div>\n\n                <div className=\"flex items-center gap-3 border-b p-3\">\n                    <span className=\"font-medium\">To:</span>\n                    <input\n                        className=\"outline-none w-full\"\n                        type=\"text\"\n                        placeholder=\"Search User..\"\n                        value={searchTerm}\n                        onChange={(e) => setSearchTerm(e.target.value)}\n                    />\n                </div>\n\n                <div className=\"flex flex-col overflow-x-hidden h-96 w-full\">\n\n                    {loading ?\n                        Array(8).fill(\"\").map((el, i) => (\n                            <div className=\"flex items-center gap-2 py-2 px-4\" key={i}>\n                                <Skeleton animation=\"wave\" variant=\"circular\" width={60} height={50} />\n                                <div className=\"flex flex-col gap-0 w-full\">\n                                    <Skeleton height={23} width=\"45%\" animation=\"wave\" />\n                                    <Skeleton height={23} width=\"30%\" animation=\"wave\" />\n                                </div>\n                            </div>\n                        ))\n                        : users.length > 0 ?\n                            users.map((u) => (\n                                <div onClick={() => addToChat(u._id)} className=\"flex items-center hover:bg-gray-50 py-2 px-4 cursor-pointer\" key={u._id}>\n                                    <div className=\"flex space-x-3 items-center\">\n                                        <img draggable=\"false\" className=\"w-11 h-11 rounded-full object-cover\" src={u.avatar} alt=\"avatar\" />\n                                        <div className=\"flex flex-col items-start\">\n                                            <span className=\"text-black text-sm font-semibold\">{u.username}</span>\n                                            <span className=\"text-gray-400 text-sm\">{u.name}</span>\n                                        </div>\n                                    </div>\n                                </div>\n                            ))\n                            :\n                            <span className=\"text-gray-400 text-sm p-2\">No accounts found.</span>\n                    }\n\n                </div>\n            </div>\n        </Dialog >\n    )\n}\n\nexport default NewDialog"]},"metadata":{},"sourceType":"module"}