{"ast":null,"code":"import _asyncToGenerator from\"D:/New folder (4)/instagram-mern-main/backend/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/New folder (4)/instagram-mern-main/backend/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"D:\\\\New folder (4)\\\\instagram-mern-main\\\\backend\\\\frontend\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import{useEffect,useRef,useState}from'react';import{useDispatch,useSelector}from'react-redux';import{Link}from'react-router-dom';import{addComment,likePost,savePost}from'../../actions/postAction';import{likeFill}from'../Navbar/SvgIcons';import{commentIcon,emojiIcon,likeIconOutline,moreIcons,saveIconFill,saveIconOutline,shareIcon}from'./SvgIcons';import{Picker}from'emoji-mart';import ScrollToBottom from'react-scroll-to-bottom';import axios from'axios';import moment from'moment';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PostItem=function PostItem(_ref){var _id=_ref._id,caption=_ref.caption,likes=_ref.likes,comments=_ref.comments,image=_ref.image,postedBy=_ref.postedBy,savedBy=_ref.savedBy,createdAt=_ref.createdAt,setUsersDialog=_ref.setUsersDialog,setUsersList=_ref.setUsersList;var dispatch=useDispatch();var commentInput=useRef(null);var _useSelector=useSelector(function(state){return state.user;}),user=_useSelector.user;// const { loading, post } = useSelector((state) => state.postDetails);\nvar _useState=useState(likes),_useState2=_slicedToArray(_useState,2),allLikes=_useState2[0],setAllLikes=_useState2[1];var _useState3=useState(comments),_useState4=_slicedToArray(_useState3,2),allComments=_useState4[0],setAllComments=_useState4[1];var _useState5=useState(savedBy),_useState6=_slicedToArray(_useState5,2),allSavedBy=_useState6[0],setAllSavedBy=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),liked=_useState8[0],setLiked=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),saved=_useState10[0],setSaved=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),comment=_useState12[0],setComment=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),viewComment=_useState14[0],setViewComment=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),showEmojis=_useState16[0],setShowEmojis=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),likeEffect=_useState18[0],setLikeEffect=_useState18[1];var handleLike=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$axios$get,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLiked(!liked);_context.next=3;return dispatch(likePost(_id));case 3:_context.next=5;return axios.get(\"/api/v1/post/detail/\".concat(_id));case 5:_yield$axios$get=_context.sent;data=_yield$axios$get.data;setAllLikes(data.post.likes);case 8:case\"end\":return _context.stop();}}},_callee);}));return function handleLike(){return _ref2.apply(this,arguments);};}();var handleComment=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var _yield$axios$get2,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();_context2.next=3;return dispatch(addComment(_id,comment));case 3:setComment(\"\");_context2.next=6;return axios.get(\"/api/v1/post/detail/\".concat(_id));case 6:_yield$axios$get2=_context2.sent;data=_yield$axios$get2.data;setAllComments(data.post.comments);case 9:case\"end\":return _context2.stop();}}},_callee2);}));return function handleComment(_x){return _ref3.apply(this,arguments);};}();var handleSave=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var _yield$axios$get3,data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:setSaved(!saved);_context3.next=3;return dispatch(savePost(_id));case 3:_context3.next=5;return axios.get(\"/api/v1/post/detail/\".concat(_id));case 5:_yield$axios$get3=_context3.sent;data=_yield$axios$get3.data;setAllSavedBy(data.post.savedBy);case 8:case\"end\":return _context3.stop();}}},_callee3);}));return function handleSave(){return _ref4.apply(this,arguments);};}();var handleLikeModal=function handleLikeModal(){setUsersDialog(true);setUsersList(allLikes);};var setLike=function setLike(){setLikeEffect(true);setTimeout(function(){setLikeEffect(false);},500);if(liked){return;}handleLike();};useEffect(function(){setLiked(allLikes.some(function(u){return u._id===user._id;}));},[allLikes]);useEffect(function(){setSaved(allSavedBy.some(function(id){return id===user._id;}));},[allSavedBy]);return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col border rounded bg-white relative\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between px-3 py-2.5 border-b items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3 items-center\",children:[/*#__PURE__*/_jsx(Link,{to:\"/\".concat(postedBy.username),children:/*#__PURE__*/_jsx(\"img\",{draggable:\"false\",className:\"w-10 h-10 rounded-full object-cover\",src:postedBy.avatar,alt:\"avatar\"})}),/*#__PURE__*/_jsx(Link,{to:\"/\".concat(postedBy.username),className:\"text-black text-sm font-semibold\",children:postedBy.username})]}),/*#__PURE__*/_jsx(\"span\",{className:\"cursor-pointer\",children:moreIcons})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative flex items-center justify-center\",onDoubleClick:setLike,children:[/*#__PURE__*/_jsx(\"img\",{draggable:\"false\",loading:\"lazy\",className:\"w-full h-full object-cover object-center\",src:image,alt:\"post image\"}),likeEffect&&/*#__PURE__*/_jsx(\"img\",{draggable:\"false\",height:\"80px\",className:\"likeEffect\",alt:\"heart\",src:\"https://img.icons8.com/ios-filled/2x/ffffff/like.png\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col px-4 space-y-1 border-b pb-2 mt-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between py-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleLike,children:liked?likeFill:likeIconOutline}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return commentInput.current.focus();},children:commentIcon}),shareIcon]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSave,children:saved?saveIconFill:saveIconOutline})]}),/*#__PURE__*/_jsxs(\"span\",{onClick:handleLikeModal,className:\"font-semibold text-sm cursor-pointer\",children:[allLikes.length,\" likes\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-auto items-center space-x-1\",children:[/*#__PURE__*/_jsx(Link,{to:\"/\".concat(postedBy.username),className:\"text-sm font-semibold hover:underline\",children:postedBy.username}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm truncate\",children:caption})]}),allComments.length>0?/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){return setViewComment(!viewComment);},className:\"text-[13px] text-gray-500 cursor-pointer\",children:viewComment?\"Hide Comments\":allComments.length===1?\"View \".concat(allComments.length,\" Comment\"):\"View All \".concat(allComments.length,\" Comments\")}):/*#__PURE__*/_jsx(\"span\",{className:\"text-[13px] text-gray-500\",children:\"No Comments Yet!\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-gray-500 cursor-pointer\",children:moment(createdAt).fromNow()}),viewComment&&/*#__PURE__*/_jsx(ScrollToBottom,{className:\"w-full h-52 overflow-y-auto py-1\",children:allComments.map(function(c){return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start mb-2 space-x-2\",children:[/*#__PURE__*/_jsx(\"img\",{draggable:\"false\",className:\"h-7 w-7 rounded-full object-cover mr-0.5\",src:c.user.avatar,alt:\"avatar\"}),/*#__PURE__*/_jsx(Link,{to:\"/\".concat(c.user),className:\"text-sm font-semibold hover:underline\",children:c.user.username}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm\",children:c.comment})]},c._id);})})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleComment,className:\"flex items-center justify-between p-3 w-full space-x-3\",children:[/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){return setShowEmojis(!showEmojis);},className:\"cursor-pointer\",children:emojiIcon}),showEmojis&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute bottom-12 -left-2\",children:/*#__PURE__*/_jsx(Picker,{set:\"google\",onSelect:function onSelect(e){return setComment(comment+e.native);},title:\"Emojis\"})}),/*#__PURE__*/_jsx(\"input\",{className:\"flex-auto text-sm outline-none border-none bg-transparent\",type:\"text\",value:comment,ref:commentInput,required:true,onFocus:function onFocus(){return setShowEmojis(false);},onChange:function onChange(e){return setComment(e.target.value);},placeholder:\"Add a comment...\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"\".concat(comment.trim().length<1?'text-blue-300':'text-primary-blue',\" text-sm font-semibold\"),disabled:comment.trim().length<1,children:\"Post\"})]})]});};export default PostItem;","map":{"version":3,"sources":["D:/New folder (4)/instagram-mern-main/backend/frontend/src/components/Home/PostItem.jsx"],"names":["useEffect","useRef","useState","useDispatch","useSelector","Link","addComment","likePost","savePost","likeFill","commentIcon","emojiIcon","likeIconOutline","moreIcons","saveIconFill","saveIconOutline","shareIcon","Picker","ScrollToBottom","axios","moment","PostItem","_id","caption","likes","comments","image","postedBy","savedBy","createdAt","setUsersDialog","setUsersList","dispatch","commentInput","state","user","allLikes","setAllLikes","allComments","setAllComments","allSavedBy","setAllSavedBy","liked","setLiked","saved","setSaved","comment","setComment","viewComment","setViewComment","showEmojis","setShowEmojis","likeEffect","setLikeEffect","handleLike","get","data","post","handleComment","e","preventDefault","handleSave","handleLikeModal","setLike","setTimeout","some","u","id","username","avatar","current","focus","length","fromNow","map","c","native","target","value","trim"],"mappings":"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","sourcesContent":["import { useEffect, useRef, useState } from 'react'\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport { addComment, likePost, savePost } from '../../actions/postAction';\nimport { likeFill } from '../Navbar/SvgIcons';\nimport { commentIcon, emojiIcon, likeIconOutline, moreIcons, saveIconFill, saveIconOutline, shareIcon } from './SvgIcons'\nimport { Picker } from 'emoji-mart'\nimport ScrollToBottom from 'react-scroll-to-bottom';\nimport axios from 'axios';\nimport moment from 'moment';\n\nconst PostItem = ({ _id, caption, likes, comments, image, postedBy, savedBy, createdAt, setUsersDialog, setUsersList }) => {\n\n    const dispatch = useDispatch();\n    const commentInput = useRef(null);\n\n    const { user } = useSelector((state) => state.user);\n    // const { loading, post } = useSelector((state) => state.postDetails);\n\n    const [allLikes, setAllLikes] = useState(likes);\n    const [allComments, setAllComments] = useState(comments);\n    const [allSavedBy, setAllSavedBy] = useState(savedBy);\n\n    const [liked, setLiked] = useState(false);\n    const [saved, setSaved] = useState(false);\n    const [comment, setComment] = useState(\"\");\n    const [viewComment, setViewComment] = useState(false);\n    const [showEmojis, setShowEmojis] = useState(false);\n\n    const [likeEffect, setLikeEffect] = useState(false);\n\n    const handleLike = async () => {\n        setLiked(!liked);\n        await dispatch(likePost(_id));\n        const { data } = await axios.get(`/api/v1/post/detail/${_id}`)\n        setAllLikes(data.post.likes)\n    }\n\n    const handleComment = async (e) => {\n        e.preventDefault();\n        await dispatch(addComment(_id, comment));\n        setComment(\"\");\n        const { data } = await axios.get(`/api/v1/post/detail/${_id}`)\n        setAllComments(data.post.comments)\n    }\n\n    const handleSave = async () => {\n        setSaved(!saved);\n        await dispatch(savePost(_id));\n        const { data } = await axios.get(`/api/v1/post/detail/${_id}`)\n        setAllSavedBy(data.post.savedBy)\n    }\n\n    const handleLikeModal = () => {\n        setUsersDialog(true);\n        setUsersList(allLikes);\n    }\n\n    const setLike = () => {\n        setLikeEffect(true)\n        setTimeout(() => {\n            setLikeEffect(false)\n        }, 500)\n        if (liked) {\n            return;\n        }\n        handleLike();\n    }\n\n    useEffect(() => {\n        setLiked(allLikes.some((u) => u._id === user._id))\n    }, [allLikes]);\n\n    useEffect(() => {\n        setSaved(allSavedBy.some((id) => id === user._id))\n    }, [allSavedBy]);\n\n\n    return (\n        <div className=\"flex flex-col border rounded bg-white relative\">\n\n            <div className=\"flex justify-between px-3 py-2.5 border-b items-center\">\n                <div className=\"flex space-x-3 items-center\">\n                    <Link to={`/${postedBy.username}`}><img draggable=\"false\" className=\"w-10 h-10 rounded-full object-cover\" src={postedBy.avatar} alt=\"avatar\" /></Link>\n                    <Link to={`/${postedBy.username}`} className=\"text-black text-sm font-semibold\">{postedBy.username}</Link>\n                </div>\n                <span className=\"cursor-pointer\">{moreIcons}</span>\n            </div>\n\n            {/* post image container */}\n            <div className=\"relative flex items-center justify-center\" onDoubleClick={setLike}>\n                <img draggable=\"false\" loading=\"lazy\" className=\"w-full h-full object-cover object-center\" src={image} alt=\"post image\" />\n                {likeEffect &&\n                    <img draggable=\"false\" height=\"80px\" className=\"likeEffect\" alt=\"heart\" src=\"https://img.icons8.com/ios-filled/2x/ffffff/like.png\" />\n                }\n            </div>\n\n            {/* like comment container */}\n            <div className=\"flex flex-col px-4 space-y-1 border-b pb-2 mt-2\">\n\n                {/* icons container */}\n                <div className=\"flex items-center justify-between py-2\">\n                    <div className=\"flex space-x-4\">\n                        <button onClick={handleLike}>{liked ? likeFill : likeIconOutline}</button>\n                        <button onClick={() => commentInput.current.focus()}>{commentIcon}</button>\n                        {shareIcon}\n                    </div>\n                    <button onClick={handleSave}>{saved ? saveIconFill : saveIconOutline}</button>\n                </div>\n\n                {/* likes  */}\n                <span onClick={handleLikeModal} className=\"font-semibold text-sm cursor-pointer\">{allLikes.length} likes</span>\n\n                {/* comment */}\n                <div className=\"flex flex-auto items-center space-x-1\">\n                    <Link to={`/${postedBy.username}`} className=\"text-sm font-semibold hover:underline\">{postedBy.username}</Link>\n                    <span className=\"text-sm truncate\">{caption}</span>\n                </div>\n\n                {/* time */}\n                {allComments.length > 0 ?\n\n                    <span onClick={() => setViewComment(!viewComment)} className=\"text-[13px] text-gray-500 cursor-pointer\">\n                        {viewComment ? \"Hide Comments\" :\n                            allComments.length === 1 ?\n                                `View ${allComments.length} Comment` :\n                                `View All ${allComments.length} Comments`\n                        }\n                    </span> :\n\n                    <span className=\"text-[13px] text-gray-500\">No Comments Yet!</span>\n\n                }\n                <span className=\"text-xs text-gray-500 cursor-pointer\">{moment(createdAt).fromNow()}</span>\n\n                {viewComment &&\n                    <ScrollToBottom className=\"w-full h-52 overflow-y-auto py-1\">\n                        {allComments.map((c) => (\n                            <div className=\"flex items-start mb-2 space-x-2\" key={c._id}>\n                                <img draggable=\"false\" className=\"h-7 w-7 rounded-full object-cover mr-0.5\" src={c.user.avatar} alt=\"avatar\" />\n                                <Link to={`/${c.user}`} className=\"text-sm font-semibold hover:underline\">{c.user.username}</Link>\n                                <p className=\"text-sm\">{c.comment}</p>\n                            </div>\n                        ))}\n                    </ScrollToBottom>\n                }\n\n            </div>\n\n            {/* comment input container */}\n            <form onSubmit={handleComment} className=\"flex items-center justify-between p-3 w-full space-x-3\">\n                <span onClick={() => setShowEmojis(!showEmojis)} className=\"cursor-pointer\">{emojiIcon}</span>\n\n                {showEmojis && (\n                    <div className=\"absolute bottom-12 -left-2\">\n                        <Picker\n                            set=\"google\"\n                            onSelect={(e) => setComment(comment + e.native)}\n                            title=\"Emojis\"\n                        />\n                    </div>\n                )}\n\n                <input\n                    className=\"flex-auto text-sm outline-none border-none bg-transparent\"\n                    type=\"text\"\n                    value={comment}\n                    ref={commentInput}\n                    required\n                    onFocus={() => setShowEmojis(false)}\n                    onChange={(e) => setComment(e.target.value)}\n                    placeholder=\"Add a comment...\" />\n                <button type=\"submit\" className={`${comment.trim().length < 1 ? 'text-blue-300' : 'text-primary-blue'} text-sm font-semibold`} disabled={comment.trim().length < 1}>Post</button>\n            </form>\n\n        </div >\n    )\n}\n\nexport default PostItem"]},"metadata":{},"sourceType":"module"}